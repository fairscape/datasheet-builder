<div class="subcrates-container">
  {% if subcrates %} {% for subcrate in subcrates %}
  <div class="subcrate-summary">
    <h3 class="subcrate-title">{{ subcrate.name }}</h3>
    <div class="subcrate-metadata">
      <div class="metadata-item">
        <span class="metadata-label">ROCrate ID:</span>
        <span class="metadata-value"
          ><a href="https://fairscape.net/{{ subcrate.id }}"
            >{{ subcrate.id }}</a
          ></span
        >
      </div>
      <div class="metadata-item">
        <span class="metadata-label">Description:</span>
        <span class="metadata-value">{{ subcrate.description }}</span>
      </div>
      <div class="metadata-item">
        <span class="metadata-label">Authors:</span>
        <span class="metadata-value">{{ subcrate.authors }}</span>
      </div>
      <div class="metadata-item">
        <span class="metadata-label">Date:</span>
        <span class="metadata-value"
          >{{ subcrate.date if subcrate.date else "Not specified" }}</span
        >
      </div>
      <div class="metadata-item">
        <span class="metadata-label">Size:</span>
        <span class="metadata-value">{{ subcrate.size }}</span>
      </div>
      <div class="metadata-item">
        <span class="metadata-label">DOI:</span>
        <span class="metadata-value"
          >{{ subcrate.doi if subcrate.doi else "None" }}</span
        >
      </div>
      <div class="metadata-item">
        <span class="metadata-label">Contact:</span>
        <span class="metadata-value"
          >{{ subcrate.contact if subcrate.contact else "Not specified" }}</span
        >
      </div>
      <div class="metadata-item">
        <span class="metadata-label">License:</span>
        <span class="metadata-value">{{ subcrate.license }}</span>
      </div>
      <div class="metadata-item">
        <span class="metadata-label">Confidentiality:</span>
        <span class="metadata-value"
          >{{ subcrate.confidentiality if subcrate.confidentiality else "Not
          specified" }}</span
        >
      </div>
      <div class="metadata-item">
        <span class="metadata-label">Keywords:</span>
        <span class="metadata-value">
          {% if subcrate.keywords is string %} {{ subcrate.keywords }} {% else
          %} {{ subcrate.keywords|join(', ') }} {% endif %}
        </span>
      </div>

      {% if subcrate.related_publications %}
      <div class="metadata-item">
        <span class="metadata-label">Related Publications:</span>
        <span class="metadata-value">
          <ul>
            {% for pub in subcrate.related_publications %}
            <li>{{ pub }}</li>
            {% endfor %}
          </ul>
        </span>
      </div>
      {% endif %} {% if subcrate.file_access %}
      <div class="metadata-item">
        <span class="metadata-label">Access:</span>
        <span class="metadata-value">
          {% for access_type, count in subcrate.file_access.items() %} {{
          access_type }}: {{ count }}{% if not loop.last %}, {% endif %} {%
          endfor %}
        </span>
      </div>
      {% endif %}
    </div>

    <div class="subcrate-composition">
      <h4>Content Summary</h4>
      <div class="composition-grid">
        <div class="composition-card">
          <div class="card-header">
            <span class="card-icon">üìä</span>
            <span class="card-title">Files ({{ subcrate.files_count }})</span>
          </div>
          <div class="card-content">
            <div class="card-stats">
              <div class="stat-item">
                <span class="stat-label">Formats:</span>
                <span class="stat-value">
                  {% for fmt, count in subcrate.file_formats.items() %} {{ fmt
                  }} ({{ count }}){% if not loop.last %}, {% endif %} {% endfor
                  %}
                </span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Access:</span>
                <span class="stat-value">
                  {% for acc, count in subcrate.file_access.items() %} {{ acc }}
                  ({{ count }}){% if not loop.last %}, {% endif %} {% endfor %}
                </span>
              </div>
            </div>
          </div>
        </div>

        <div class="composition-card">
          <div class="card-header">
            <span class="card-icon">üíª</span>
            <span class="card-title"
              >Software ({{ subcrate.software_count }})</span
            >
          </div>
          <div class="card-content">
            <div class="card-stats">
              <div class="stat-item">
                <span class="stat-label">Formats:</span>
                <span class="stat-value">
                  {% for fmt, count in subcrate.software_formats.items() %} {{
                  fmt }} ({{ count }}){% if not loop.last %}, {% endif %} {%
                  endfor %}
                </span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Access:</span>
                <span class="stat-value">
                  {% for acc, count in subcrate.software_access.items() %} {{
                  acc }} ({{ count }}){% if not loop.last %}, {% endif %} {%
                  endfor %}
                </span>
              </div>
            </div>
          </div>
        </div>

        <div class="composition-card">
          <div class="card-header">
            <span class="card-icon">‚öôÔ∏è</span>
            <span class="card-title">Other Components</span>
          </div>
          <div class="card-content">
            <div class="card-stats">
              <div class="stat-item">
                <span class="stat-label">Computations:</span>
                <span class="stat-value"
                  >{{ subcrate.computations_count }}</span
                >
              </div>
              <div class="stat-item">
                <span class="stat-label">Schemas:</span>
                <span class="stat-value">{{ subcrate.schemas_count }}</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Other:</span>
                <span class="stat-value">{{ subcrate.other_count }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="view-full-link">
      <a href="{{ subcrate.metadata_path.split('/')[0] }}/ro-crate-preview.html"
        >View Full Subcrate Details</a
      >
    </div>
  </div>
  {% endfor %} {% else %}
  <p>No subcrates found.</p>
  {% endif %}
</div>
